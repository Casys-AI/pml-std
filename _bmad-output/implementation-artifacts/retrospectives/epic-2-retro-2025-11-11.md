# R√©trospective Epic 2: DAG Execution & Production Readiness

**Date:** 2025-11-11 **Facilitateur:** Bob (Scrum Master) **Participants:** BMad (PO), John (PM),
Winston (Architect), Amelia (Dev), Murat (TEA), Sally (UX Designer)

---

## üìä Epic 2 Summary

**Objectif:** Impl√©menter la parall√©lisation des workflows via DAG execution et pr√©parer le syst√®me
pour production

**Delivery Metrics:**

- **Compl√©t√©:** 7/7 stories (100%)
- **Stories:**
  - 2.1 - Dependency Graph Construction (DAG Builder) ‚úÖ
  - 2.2 - Parallel Execution Engine ‚úÖ
  - 2.3 - SSE Streaming pour Progressive Results ‚úÖ
  - 2.4 - MCP Gateway Integration avec Claude Code ‚úÖ
  - 2.5 - Health Checks & MCP Server Monitoring ‚úÖ
  - 2.6 - Error Handling & Resilience ‚úÖ
  - 2.7 - End-to-End Tests & Production Hardening ‚úÖ

**Livrables cl√©s r√©alis√©s:**

- ‚úÖ Dependency graph construction automatique
- ‚úÖ Parallel executor avec SSE streaming
- ‚úÖ Gateway MCP int√©gr√© avec Claude Code
- ‚úÖ Health checks et observability
- ‚úÖ Tests end-to-end et production hardening

---

## üéØ Ce Qui A Bien Fonctionn√© (Successes)

### 1. Tests E2E Robustes et Maintenables

**Observation:** Story 2.7 a livr√© une suite de tests end-to-end qui fonctionnent de mani√®re
consistante et fournissent une vraie confiance dans le syst√®me.

**Exemples sp√©cifiques:**

- Tests avec vrais MCP servers (pas des mocks) - validation en conditions r√©elles
- Coverage des edge cases : √©checs, timeouts, erreurs de parsing
- Load testing validant que le parallel executor scale correctement
- Feedback rapide pour les d√©veloppeurs pendant l'impl√©mentation

**Impact positif:**

- Amelia (Dev) : "Les tests E2E m'ont sauv√© plusieurs fois. Cycle de feedback rapide."
- Murat (TEA) : "Infrastructure de test maintenable - tests rapides √† run et faciles √† debug"
- Winston (Architect) : "Preuve que l'architecture tient ses promesses d'int√©gration"

**Pattern √† r√©p√©ter:** Tests E2E qui testent avec vrais services, couvrent les edge cases, et
fournissent feedback rapide.

---

## ‚ö†Ô∏è Challenges et Growth Areas

### 1. Gap de Validation Utilisateur

**Probl√®me:** Deux epics complets (Epic 1 + Epic 2) d√©velopp√©s sans aucune validation utilisateur
r√©elle. Z√©ro feedback externe.

**Citation cl√© (BMad):** "C'est juste qu'on dev mais on a test√© aucun user"

**Root cause identifi√©e:**

- Mindset "√ßa doit √™tre parfait avant de le partager" (John PM)
- Attente que le MVP soit "complet" avant de montrer quoi que ce soit
- Pas de strat√©gie de recrutement d'early testers

**Impact:**

- D√©moabilit√© du syst√®me peu claire, m√™me pour l'√©quipe
- Pas de validation que la value proposition r√©sonne avec les users
- Risque de d√©couvrir des probl√®mes d'adoption trop tard

**Pattern √† corriger:** Construire sans validation utilisateur incr√©mentale.

---

### 2. Gap de D√©finition Produit - Mod√®le d'Int√©gration MCP

**Probl√®me CRITIQUE:** M√™me l'√©quipe qui a construit le syst√®me ne sait pas clairement comment il
s'int√®gre avec Claude Code.

**Citations cl√©s:**

- BMad: "Aujourd'hui on sait pas comment √ßa fonctionne en fait. Et comment quelqu'un peut l'ajouter
  √† son Claude Code"
- BMad: "Il doit d√©j√† avoir tous les MCP qu'il veut dans son mcp.json ou il peut les rajouter apr√®s
  et comment?"
- Winston: "Je r√©alise maintenant que je ne suis pas s√ªr lequel [mod√®le d'int√©gration] on a
  impl√©ment√©"

**Questions non r√©pondues:**

- Comment ajouter/enlever des MCP servers √† la gateway?
- Casys PML est-il un proxy transparent, un server additionnel, ou un wrapper?
- Quelle est la configuration exacte requise dans Claude Code?
- Peut-on hot-reload quand on ajoute des servers?

**Root cause:**

- PRD avec user journeys th√©oriques mais sans d√©tails d'int√©gration
- Composants techniques valid√©s individuellement sans d√©finir le contrat d'int√©gration
- Pas de validation end-to-end du flow utilisateur r√©el

**Impact:**

- **BLOQUANT pour Epic 3** - Story 3.4 (expose execute_code tool) ne peut pas √™tre impl√©ment√©e sans
  clarifier √ßa
- Impossible d'onboarder des early testers sans savoir comment ils installent le syst√®me
- Gap entre "le code fonctionne" et "c'est utilisable par quelqu'un d'externe"

---

### 3. D√©moabilit√© Non Incluse comme Crit√®re de Qualit√©

**Probl√®me:** On a construit une gateway et un syst√®me de vector search conceptuellement puissants,
mais sans moyen facile de les d√©montrer.

**Citation cl√© (BMad):** "Ce serait bien d'avoir la possibilit√© de faire une demo facilement... ce
qui serait top ce serait d'avoir des exemples visuels"

**Insight d√©couvert:** Les gains d'Casys PML sont **invisibles** :

- Vector search se passe en coulisses
- Parall√©lisation est rapide mais pas visible
- Gains en "temps √©conomis√©" et "contexte pr√©serv√©" difficiles √† montrer

**Root cause:**

- D√©moabilit√© pas consid√©r√©e comme un crit√®re de qualit√© dans Definition of Done
- Focus sur "Est-ce que √ßa marche?" vs "Comment on le montre?"

**Impact:**

- Difficile de recruter early adopters sans demos claires
- Value proposition pas visc√©ralement compr√©hensible
- NPS >75 target menac√© sans facilit√© de d√©monstration

---

### 4. Gap de Requirements - Story 3.5 PII Detection

**Probl√®me:** Story drafted sans specifications techniques claires.

**Manque:**

- Quels types de PII? (emails, cartes, SSN, etc.)
- Quelle approche? (regex, ML model, API externe?)
- Performance attendue?
- UX quand PII d√©tect√©?

**Impact:** Story 3.5 ne peut pas √™tre developed dans cet √©tat.

---

## üí° Insights et Learning

### 1. Les Composants Techniques ‚â† Produit Utilisable

**Insight:** On peut avoir tous les composants techniques qui fonctionnent individuellement, mais √ßa
ne garantit pas un produit utilisable end-to-end.

**Application future:** Valider le user journey complet, pas juste les capabilities techniques.

---

### 2. Si L'√âquipe Ne Sait Pas Comment √áa Marche, Les Users Non Plus

**Insight:** L'incertitude de l'√©quipe sur le mod√®le d'int√©gration est un signal d'alarme pr√©coce.
Si nous, qui l'avons construit, devons "regarder le code pour comprendre", c'est que la d√©finition
produit est incompl√®te.

**Application future:** L'√©quipe doit pouvoir expliquer clairement comment utiliser le produit AVANT
de coder.

---

### 3. La D√©moabilit√© Est Une Feature, Pas Un Afterthought

**Insight:** Les syst√®mes avec gains "invisibles" ont besoin de strat√©gies de d√©monstration
explicites d√®s le design.

**Application future:** Inclure "comment on le d√©montre?" dans chaque story review.

---

## üìã Action Items

### Process Improvements

**#1: Recruter Early Testers PENDANT Epic 3**

- **Owner:** John (PM)
- **Timeline:** Pendant le d√©veloppement d'Epic 3
- **Actions:**
  - Recruter 3-5 early adopters (power users avec 10+ MCP servers)
  - Les impliquer pendant le d√©veloppement, pas apr√®s
  - Observer comment ils essaient d'utiliser le syst√®me
  - Ajuster bas√© sur leurs retours en temps r√©el
- **Success criteria:** Au moins 1 user teste chaque story majeure d'Epic 3

---

**#2: Inclure D√©moabilit√© dans Definition of Done**

- **Owner:** Murat (TEA)
- **Timeline:** Imm√©diat
- **Actions:**
  - Ajouter "d√©monstrable/testable par external user" dans DoD
  - Valider chaque story avec question "comment on le montre?"
  - Cr√©er examples/demos pour chaque capability majeure
- **Success criteria:** Chaque story Epic 3 inclut un exemple d√©montrable

---

### Technical Debt & Preparation

**#3: CRITIQUE - Auditer & Documenter Mod√®le d'Int√©gration MCP**

- **Owner:** Winston (Architect) + Amelia (Dev)
- **Timeline:** AVANT toute story Epic 3
- **Priority:** CRITIQUE - BLOQUANT pour Epic 3
- **Actions:**
  - Examiner le code actuel (stories 1.3, 1.6, 2.4)
  - Documenter comment ajouter/enlever des MCP servers
  - Clarifier le mod√®le r√©el (proxy/wrapper/additionnel)
  - Sp√©cifier la configuration requise dans Claude Code
  - Valider le support du hot-reload
- **Livrable:** Document d'int√©gration avec exemples pratiques step-by-step
- **Success criteria:** N'importe quel membre de l'√©quipe peut expliquer l'int√©gration

---

**#4: Valider Extensibilit√© Test Infrastructure**

- **Owner:** Murat (TEA) + Amelia (Dev)
- **Timeline:** Avant Story 3.7
- **Actions:**
  - Documenter comment ajouter nouveaux tests E2E
  - Cr√©er test sandbox "hello world" comme proof of concept
  - Valider que l'infrastructure scale pour tests code execution
- **Livrable:** Test infrastructure extension guide
- **Success criteria:** Nouveau contributeur peut ajouter test E2E en suivant le guide

---

**#5: Clarifier Requirements Story 3.5 (PII Detection)**

- **Owner:** John (PM) + Winston (Architect)
- **Timeline:** Avant d√©veloppement de Story 3.5
- **Actions:**
  - D√©finir types de PII √† d√©tecter (scope minimal MVP)
  - Choisir approche technique (regex vs ML vs API)
  - Documenter performance requirements
  - D√©finir UX quand PII d√©tect√© (fail? warn? auto-tokenize?)
  - Mettre √† jour story 3.5 avec specs compl√®tes
- **Livrable:** Story 3.5 updated avec specs techniques claires
- **Success criteria:** Amelia peut estimer et impl√©menter sans ambigu√Øt√©

---

### Documentation

**#6: Cr√©er Quick Start Guide**

- **Owner:** Sally (UX Designer) + Amelia (Dev)
- **Timeline:** 2 jours
- **Actions:**
  - Installation en 10 minutes ou moins
  - Configuration Claude Code step-by-step
  - Premier workflow exemple avec before/after metrics
  - Troubleshooting common issues
- **Livrable:** README.md avec quick start complet
- **Success criteria:** External user peut installer et run premier workflow en 10 min

---

## üöÄ Epic 3 Preparation Sprint

**Total Estimated Effort:** 5 jours

### Technical Setup

- [x] **Architecture spike - MCP tools injection design** (Winston, 1 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - Design comment injecter MCP tools dans sandbox context
  - Proof of concept de vector search depuis code TypeScript
  - **Livrable:** docs/architecture-spike-mcp-tools-injection.md
  - **POC:** tests/poc/pml-bridge.ts + sandbox-worker.ts
  - **Summary:** docs/architecture-spike-summary.md
- [x] **Deno sandbox proof-of-concept** (Amelia, 1 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - Valider permissions model et isolation
  - Tester code execution basic avec constraints
  - **Livrable:** tests/poc/deno-sandbox-executor.ts
  - **Tests:** tests/poc/deno-sandbox-simple-test.ts (4/4 passing)
  - **Summary:** docs/deno-sandbox-poc-summary.md
- [x] **PII detection research & tool selection** (John + Winston, 0.5 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - √âvaluer options (regex libraries, ML models, APIs)
  - Recommander approche pour MVP
  - **Livrable:** docs/pii-detection-research.md
  - **Recommandation:** validator.js via npm (93M weekly downloads, industry standard)
  - **Raison:** Battle-tested, Luhn algorithm built-in, RFC5322 compliant, zero maintenance
  - **Decision:** Warn + Allow UX strategy, <10ms performance target

### Knowledge Development

- [x] **Deno permissions deep dive** (Amelia, 0.5 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - Comprendre security model en d√©tail
  - Documenter best practices
  - **Livrable:** docs/deno-permissions-deep-dive.md
  - **Contenu:** Permission types, scoping, deny flags, inheritance, best practices, security
    patterns
- [x] **Sandboxing security best practices** (Winston, 0.5 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - Research security patterns pour code execution
  - Identifier vuln√©rabilit√©s potentielles
  - **Livrable:** docs/sandboxing-security-best-practices.md
  - **Contenu:** Threat model, attack surface, security controls, defense-in-depth, common
    vulnerabilities, mitigation strategies, security testing, incident response

### Cleanup/Documentation

- [x] **Document mod√®le d'int√©gration MCP** (Winston + Amelia, 1 jour) **CRITIQUE** ‚úÖ COMPL√âT√â
      2025-11-11
  - R√©sultat d'Action Item #3
  - Bloquant pour toutes stories Epic 3
  - **Livrable:** docs/mcp-integration-model.md
- [x] **Test infrastructure extension guide** (Murat, 0.5 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - R√©sultat d'Action Item #4
  - **Livrable:** docs/test-infrastructure-extension-guide.md
  - **Contenu:** Test patterns, sandbox testing, mocking vs real services, debugging, performance
    testing
- [x] **Quick Start Guide** (Sally + Amelia, 0.5 jour) ‚úÖ COMPL√âT√â 2025-11-11
  - R√©sultat d'Action Item #6
  - **Livrable:** docs/quick-start-guide.md
  - **Contenu:** Installation (5 min), configuration (3 min), first run (2 min), troubleshooting,
    use cases

---

## ‚ö†Ô∏è Critical Path - Bloqueurs Epic 3

### Must Complete Before Epic 3 Start

**1. Document Mod√®le d'Int√©gration MCP**

- **Owner:** Winston + Amelia
- **Priority:** CRITIQUE
- **Rationale:** Story 3.4 (expose execute_code tool) impossible sans √ßa
- **Must complete by:** Avant toute story Epic 3
- **Dependencies:** Aucune - peut commencer imm√©diatement

---

**2. Clarifier PII Detection Requirements**

- **Owner:** John + Winston
- **Priority:** HIGH
- **Rationale:** Story 3.5 ne peut pas √™tre developed sans specs
- **Must complete by:** Avant Story 3.5
- **Dependencies:** Aucune - peut commencer imm√©diatement

---

### Dependencies Timeline

```
Semaine 1 (Preparation Sprint):
‚îú‚îÄ Day 1-2: Auditer int√©gration MCP [BLOQUANT] ‚Üê Winston + Amelia
‚îú‚îÄ Day 2-3: Architecture spike tools injection ‚Üê Winston
‚îú‚îÄ Day 3-4: Deno sandbox POC ‚Üê Amelia
‚îú‚îÄ Day 3-4: PII detection research ‚Üê John + Winston
‚îú‚îÄ Day 4-5: Documentation & guides ‚Üê Murat + Sally
‚îî‚îÄ Day 5: Prep sprint review & Epic 3 kickoff

Semaine 2+: Epic 3 Stories (ready to start)
```

---

## üéØ Risk Mitigation Strategies

### Risque #1: R√©p√©ter Pattern "Dev Sans Users"

- **Impact:** Arriver √† fin Epic 3 sans validation d'adoption
- **Probabilit√©:** HIGH (d√©j√† arriv√© sur Epic 1 + 2)
- **Mitigation:** Recruter 3-5 testers PENDANT Epic 3, pas apr√®s
- **Owner:** John (PM)

### Risque #2: S√©curit√© du Sandbox

- **Impact:** Vuln√©rabilit√©s d'isolation = risque s√©curit√© majeur
- **Probabilit√©:** MEDIUM
- **Mitigation:** Security review apr√®s Story 3.1, avant exposition publique
- **Owner:** Winston (Architect)

### Risque #3: Complexit√© MCP Tools Injection

- **Impact:** Story 3.2 bloqu√©e ou mal impl√©ment√©e
- **Probabilit√©:** MEDIUM
- **Mitigation:** Gap int√©gration r√©solu + architecture spike AVANT Story 3.2
- **Owner:** Winston + Amelia

### Risque #4: Performance D√©couverte Tard

- **Impact:** Caching (Story 3.6) devient du band-aid
- **Probabilit√©:** MEDIUM
- **Mitigation:** Performance benchmarks d√®s Story 3.1, pas √† la fin
- **Owner:** Murat (TEA)

---

## ü§ù Team Agreements

1. ‚úÖ **Ne plus d√©velopper d'epic complet sans validation utilisateur**
   - Minimum 3-5 early testers par epic
   - Feedback loops pendant d√©veloppement, pas apr√®s

2. ‚úÖ **Inclure d√©moabilit√© dans Definition of Done**
   - Chaque story r√©pond √† "comment on le montre?"
   - Examples/demos cr√©√©s pour capabilities majeures

3. ‚úÖ **Documenter l'int√©gration AVANT d'impl√©menter features**
   - Si l'√©quipe ne peut pas expliquer clairement, c'est pas pr√™t
   - User journeys valid√©s end-to-end, pas juste th√©oriques

4. ‚úÖ **Valider assumptions techniques t√¥t via spikes et POCs**
   - Pas d'assumptions non valid√©es dans stories
   - Spikes techniques AVANT impl√©mentation de features complexes

---

## üìä Next Epic Preview: Epic 3 Dependencies

### Ce Qu'Epic 3 N√©cessite d'Epic 2

**D√©pendances Critiques:**

1. **DAG Executor (Story 2.2)** - Sandbox s'int√®gre comme nodes DAG
2. **SSE Streaming (Story 2.3)** - Stream r√©sultats code execution
3. **MCP Gateway (Story 2.4)** - Expose le tool `execute_code`
4. **Error Handling (Story 2.6)** - Gestion erreurs sandbox

**√âtat de Pr√©paration:**

- ‚úÖ Composants techniques Epic 2 fonctionnels
- ‚ö†Ô∏è Mod√®le d'int√©gration √† clarifier (BLOQUANT)
- ‚ö†Ô∏è Test infrastructure √† valider pour extensibilit√©

---

## üéì Key Lessons Learned

1. **"√áa marche" ‚â† "C'est utilisable"**
   - Tests techniques passing ne garantissent pas adoption utilisateur
   - Valider avec vrais users, pas juste test suites

2. **L'incertitude de l'√©quipe = Signal d'alarme**
   - Si nous ne savons pas comment √ßa marche, les users non plus
   - Documentation et clart√© avant coding

3. **D√©moabilit√© = Feature, pas afterthought**
   - Syst√®mes avec gains invisibles n√©cessitent strat√©gie de d√©monstration
   - "Comment on le montre?" d√®s le design

4. **Validation incr√©mentale > Perfection diff√©r√©e**
   - Early feedback √©vite semaines de rework
   - Imperfect + tested > Perfect + untested

---

## ‚úÖ Retrospective Closure

**Epic 2 Status:** Compl√©t√© - 7/7 stories done **Retrospective Status:** Compl√©t√©e **Action Items
Committed:** 6 **Preparation Tasks Defined:** 7 **Critical Path Items:** 2

**Next Steps:**

1. Execute Preparation Sprint (5 jours)
2. Complete critical path items
3. Recruter early testers
4. Begin Epic 3 apr√®s prep sprint compl√©t√©

---

**Closing Note (Bob, Scrum Master):**

"Excellent travail √©quipe! On a d√©couvert des gaps importants qui auraient pu nous co√ªter cher plus
tard. Epic 2 a livr√© des capabilities techniques solides, mais on doit maintenant s'assurer qu'elles
sont r√©ellement utilisables.

La prochaine √©tape : ex√©cuter le preparation sprint de 5 jours avant de toucher √† Epic 3. Winston et
Amelia, votre audit du mod√®le d'int√©gration est critique - c'est le bloqueur #1.

Merci BMad d'avoir pos√© les bonnes questions difficiles. 'On ne sait pas comment √ßa fonctionne' et
'on a test√© aucun user' - ces insights vont nous faire gagner des semaines.

On se revoit apr√®s le prep sprint pour commencer Epic 3 sur des bases solides!"

---

**Document g√©n√©r√©:** 2025-11-11 **Facilit√© par:** Bob (Scrum Master) **Sauvegard√© √†:**
docs/retrospectives/epic-2-retro-2025-11-11.md
